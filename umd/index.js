!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n((e="undefined"!=typeof globalThis?globalThis:e||self).youtil={})}(this,function(e){"use strict";function n(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=Array(n);t<n;t++)r[t]=e[t];return r}function t(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function r(e,t){if(e){if("string"==typeof e)return n(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if("Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return n(e,t)}}function o(e){return function(e){if(Array.isArray(e))return n(e)}(e)||t(e)||r(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var a,c=function(){var e=document.getElementById("com_global_page_loading");e&&(e.style.display="none")};function i(e,n,t,r,o,a,c){try{var i=e[a](c),s=i.value}catch(e){t(e);return}i.done?n(s):Promise.resolve(s).then(r,o)}function s(e){return function(){var n=this,t=arguments;return new Promise(function(r,o){var a=e.apply(n,t);function c(e){i(a,r,o,c,s,"next",e)}function s(e){i(a,r,o,c,s,"throw",e)}c(void 0)})}}function l(e,n){var t,r,o,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},c=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return c.next=i(0),c.throw=i(1),c.return=i(2),"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function i(i){return function(s){return function(i){if(t)throw TypeError("Generator is already executing.");for(;c&&(c=0,i[0]&&(a=0)),a;)try{if(t=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=n.call(e,a)}catch(e){i=[6,e],r=0}finally{t=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}"function"==typeof SuppressedError&&SuppressedError;var u=function(e){if("string"==typeof e){var n=document.createElement("div");return n.innerText=e,n.innerHTML}if("object"==typeof e&&e)for(var t in e)e[t]=u(e[t]);return e},d=function(e){if("string"==typeof e){var n=document.createElement("div");return n.innerHTML=e,n.innerText}if("object"==typeof e&&e)for(var t in e)e[t]=d(e[t]);return e};function f(e,n){return function(e){if(Array.isArray(e))return e}(e)||t(e)||r(e,n)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var p=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:location.search;return(RegExp("(^|\\?|&)".concat(e,"=(.*?)(?=&|#|$)"),"g").exec(n)||[])[2]},v=function(e){return Object.keys(e||{}).filter(function(n){return void 0!==e[n]}).map(function(n){var t="object"==typeof e[n]?JSON.stringify(e[n]):e[n];return"".concat(encodeURIComponent(n),"=").concat(encodeURIComponent(t))}).join("&")};function h(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.forEach(function(n){var r,o;r=e,o=t[n],n in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o})}return e}var g=function(e,n){var t=Object.assign({},(null==e?void 0:e.headers)||{},(null==n?void 0:n.headers)||{}),r=Object.assign({},(null==e?void 0:e.fetchOptions)||{},(null==n?void 0:n.fetchOptions)||{});return Object.assign({},e||{},n||{},{headers:t,fetchOptions:r})},m=(a=s(function(e,n){var t,r,o,a,c,i,s,u,d,f,p,m,y,b,w,x,k,O,j;return l(this,function(l){switch(l.label){case 0:if(r=(t=(n=g({errorMessage:"系统繁忙，请稍后再试",errorHandler:function(e){if(!(null==n?void 0:n.silent)){var t;null==n||null===(t=n.toastHandler)||void 0===t||t.call(n,e)}throw Error(e)},baseUrl:"",headers:{},fetchOptions:{credentials:"include"},checkSuccess:function(e){return(null==e?void 0:e.code)==0||(null==e?void 0:e.code)==200},toastHandler:function(e){return console.error("[您还没有配置toastHandler，请根据您的UI组件库配置合适的提示方法] ".concat(e||""))},onFetchResponse:function(e){if(200===e.status)return e.json();var n={code:e.status,status:e.status,message:e.statusText,headers:e.headers,_response:e},t=Error(n.message);throw t.response=n,t}},n))||{}).params,o=t.data,a=t.formData,c=t.json,i=t.method,s=t.headers,u=t.baseUrl,d=t.fetchOptions,f=t.checkSuccess,p=t.afterRequest,m=t.errorHandler,y=t.errorMessage,b=t.responseConverter,w=t.onFetchResponse,d.headers=h({},s||{},d.headers||{}),r&&(d.method=i||"GET",e="".concat(e).concat(e.indexOf("?")>=0?"&":"?").concat(v(r))),o)Object.assign(d,{method:i||"POST",body:v(o),headers:h({"Content-Type":"application/x-www-form-urlencoded;charset=utf-8"},d.headers||{})});else if(a){if(x=a,!(a instanceof FormData))for(var M in x=new FormData,a)x.append(M,a[M]);Object.assign(d,{method:i||"POST",body:x})}else c&&Object.assign(d,{method:i||"POST",body:JSON.stringify(c),headers:h({"Content-Type":"application/json;charset=utf-8"},d.headers||{})});k=null,l.label=1;case 1:return l.trys.push([1,3,,4]),[4,fetch("".concat((null==e?void 0:e.indexOf("http"))===0?"":u||"").concat(e),d).then(w)];case 2:return k=l.sent(),[3,4];case 3:return console.error(O=l.sent()),null==p||p(!1,{message:null==O?void 0:O.message}),null==m||m((null===(j=O.response)||void 0===j?void 0:j.message)||y||"",O.response),[2,void 0];case 4:if(k=b?b(k):k,null==f?void 0:f(k))return null==p||p(!0,k),[2,k.data];return null==p||p(!1,k),null==m||m(k.message||k.msg||y||"",k),[2,void 0]}})}),function(e,n){return a.apply(this,arguments)}),y=function(e){var n=g(this.overrideDefaultOptions,e),t=function(e,t){return m(e,g(n,t))};return t.overrideDefaultOptions=n,t.create=y.bind(t),t};m.create=y.bind(m),e.Request=function(e,n){var t=n;return n||(t=e,e=m),function(n,r){return e(n,h({},t||{},r||{}))}},e.copyToClipboard=function(e,n,t){if(!e)throw Error("text can not be empty.");return(n=n||function(e){return console.error("复制到剪贴板失败：".concat(e||""))},navigator.clipboard&&!t)?navigator.clipboard.writeText(e).catch(function(e){throw n(e.message),e}):new Promise(function(t,r){var o=document.createElement("input");o.value=e,o.style.cssText="position:fixed;left:0;top:0;opacity:0;",document.body.appendChild(o),o.select();try{if(document.execCommand("copy"))t();else{var a="Failed to execute 'document.execCommand'.";n(a),r(Error(a))}}catch(e){n(e.message),r(e)}finally{document.body.removeChild(o)}})},e.createEnum=function(e){var n=o(e);return e.forEach(function(e){n[e.key]=e.value}),n.pick=function(n){return e.find(function(e){return e.key===n||e.value===n})},n.pickLabel=function(e){var t;return null===(t=n.pick(e))||void 0===t?void 0:t.label},n.pickValue=function(e){var t;return null===(t=n.pick(e))||void 0===t?void 0:t.value},n.pickKey=function(e){var t;return null===(t=n.pick(e))||void 0===t?void 0:t.key},n},e.decodeHtml=d,e.deepCopy=function(e){return e&&"object"==typeof e?JSON.parse(JSON.stringify(e)):e},e.delParam=function(e,n){return(n=n||"".concat(location.pathname).concat(location.search)).replace(RegExp("(^|\\?|&)".concat(e,"=.*?(&|#|$)"),"g"),function(e,n,t){return"&"===t?n:t})},e.encodeHtml=u,e.formatDate=function(e,n){var t=function(e){n=n.replace(RegExp("".concat(e,"+"),"g"),function(n){var t="".concat(r[e]);if("w"===e)return"".concat(n.length>2?"星期":"周").concat(o[t]);for(var a=0,c=t.length;a<n.length-c;a++)t="0".concat(t);return 1===n.length?t:t.substring(t.length-n.length)})};if(!e)return"";if("number"==typeof e)e=new Date(e);else if("string"==typeof e){if(/^\d{12,13}$/g.test(e))e=new Date(parseInt(e,10));else{if(!/^.{10}T.{8,12}Z?$/g.test(e))return e;e=new Date(e)}}if(!(e instanceof Date))throw Error("formatDate error: not date.");if(isNaN(null==e?void 0:e.getFullYear()))throw Error("formatDate error: invalid date.");n=n||"yyyy-MM-dd HH:mm:ss";var r={y:e.getFullYear(),M:e.getMonth()+1,d:e.getDate(),q:Math.floor((e.getMonth()+3)/3),w:e.getDay(),H:e.getHours(),h:e.getHours()%12==0?12:e.getHours()%12,m:e.getMinutes(),s:e.getSeconds(),S:e.getMilliseconds()},o=["天","一","二","三","四","五","六"];for(var a in r)t(a);return n},e.getParam=p,e.getParamInt=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:location.search;return parseInt(p(e,n)||"0",10)},e.getParams=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:location.search,n=((e||"").split("?").pop()||"").split("#")[0]||"",t={};return n.split("&").map(function(e){return e.split("=")}).forEach(function(e){var n=f(e,2),r=n[0],o=n[1];t[r]=o||""}),t},e.hideLoading=c,e.initWindowMessage=function(e,n){n||window===window.parent||(n=window.parent),!n&&window.opener&&(n=window.opener);var t,r=new Map,a=new Map,c=function(){return Math.random().toString(36).substring(2)},i={},u="_local_function_",d=function(e,n){return(null==e?void 0:e.map(function(e){if("object"==typeof e)for(var t in e)e[t]=n(e[t]);return n(e)}))||[]};function f(t){for(var o=arguments.length,a=Array(o>1?o-1:0),s=1;s<o;s++)a[s-1]=arguments[s];if(!n){console.warn("TargetWindow is null.");return}return new Promise(function(o,s){var l=c();r.set(l,{resolve:o,reject:s}),n.postMessage({scene:e,type:"event",eventName:t,payload:d(a,function(e){var n;return"function"==typeof e?(i[n="".concat(u).concat(c())]=e,n):e}),callbackId:l},"*")})}function p(e,n){a.has(e)||a.set(e,[]),a.get(e).push(n)}return window.addEventListener("message",(t=s(function(t){var c,i,s,p,v,h,g,m,y,b,w,x,k;return l(this,function(l){switch(l.label){case 0:if(!t.data||t.data.scene!==e)return[2];if(n=t.source,i=(c=t.data).type,s=c.eventName,p=c.payload,v=c.callbackId,"event"!==i)return[3,6];h=d(p,function(e){if("string"==typeof e&&e.startsWith(u)){var n="getFn_".concat(e);return function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return f.apply(void 0,["executeLocalFunction",n].concat(o(t)))}}return e}),g=a.get(s)||[],m=a.get("*")||[],l.label=1;case 1:return l.trys.push([1,4,,5]),[4,Promise.all(g.map(function(e){return Promise.resolve(e.apply(void 0,o(h)))}))];case 2:return y=l.sent(),[4,Promise.all(m.map(function(e){return Promise.resolve(e.apply(void 0,[s].concat(o(h))))}))];case 3:if(b=l.sent(),v){if(w=y[y.length-1]||b[b.length-1],!g.length&&!w)return[2];n.postMessage({scene:e,type:"callback",callbackId:v,payload:w},"*")}return[3,5];case 4:return console.error(x=l.sent()),v&&n.postMessage({scene:e,type:"callback",callbackId:v,error:x||"unknown error"},"*"),[3,5];case 5:return[3,7];case 6:"callback"===i&&v&&(k=r.get(v))&&(t.data.error?k.reject(t.data.error):k.resolve(t.data.payload),r.delete(v)),l.label=7;case 7:return[2]}})}),function(e){return t.apply(this,arguments)})),p("executeLocalFunction",function(e){for(var n=arguments.length,t=Array(n>1?n-1:0),r=1;r<n;r++)t[r-1]=arguments[r];if(!i[e=(null==e?void 0:e.replace("getFn_",""))||""])throw Error("未找到本地缓存方法：".concat(e));return i[e].apply(i,o(t))}),f("auto-connect"),{postMessage:f,onMessage:p}},e.parseDate=function(e,n){var t={y:0,M:1,d:0,H:0,h:0,m:0,s:0,S:0};(n=n||"yyyy-MM-dd").replace(/([^yMdHmsS]*?)(([yMdHmsS])\3*)([^yMdHmsS]*?)/g,function(n,r,o,a,c){return e=e.replace(RegExp("".concat(r,"(\\d{").concat(o.length,"})").concat(c)),function(e,n){return t[a]=parseInt(n,10),""}),""}),t.M--;var r=new Date(t.y,t.M,t.d,t.H,t.m,t.s);return 0!==t.S&&r.setMilliseconds(t.S),r},e.request=m,e.setParam=function(e,n,t){if(void 0!==p(e,t=t||"".concat(location.pathname).concat(location.search)))return t.replace(RegExp("(^|\\?|&)".concat(e,"=(.*?)(?=&|#|$)"),"g"),"$1".concat(e,"=").concat(n));var r=f(t.split("#"),2),o=r[0],a=r[1];return"".concat(o).concat(0>o.indexOf("?")?"?":"&").concat(e,"=").concat(n).concat(a?"#":"").concat(a||"")},e.showLoading=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"请稍候",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=(t=Object.assign({},{hasMask:!1,maskColor:"#00000070",onCancel:null,cancelInline:!1,id:"com_global_page_loading"},t)).id,o=t.hasMask,a=t.maskColor,i=t.onCancel,s=t.cancelInline,l="_".concat(r,"_timeout");window[l]&&clearTimeout(window[l]);var u=document.getElementById(r);u||((u=document.createElement("div")).id=r,u.className=r,document.body.append(u));var d="".concat(r,"_style");if(!document.getElementById(d)){var f=document.createElement("style");f.id=d,f.innerHTML="\n        .".concat(r," {\n            position: fixed;\n            left: 0;\n            top: 0;\n            width: 100vw;\n            height: 100vh;\n            display: flex;\n            justify-content: center;\n            align-items: center;\n            pointer-events: none;\n            z-index: 10000;\n        }\n        .").concat(r,".show-mask {\n            pointer-events: unset;\n            background: #00000070;\n        }\n        .").concat(r," .mask-wrapper {\n            position: fixed;\n        }\n        .").concat(r," .loading-wrapper {\n            width: 120px;\n            height: 120px;\n            z-index: 8000;\n            background: rgba(0, 0, 0, 0.6);\n            border-radius: 8px;\n            text-align: center;\n            color: white;\n            display: flex;\n            justify-content: center;\n            flex-direction: column;\n            align-items: center;\n            pointer-events: initial;\n            line-height: 1.3;\n        }\n        .").concat(r," .loading-wrapper img {\n            width: 50px;\n            height: 50px;\n            margin-bottom: 10px;\n        }\n        .").concat(r," .loading-wrapper a {\n            color: #6ab2ff;\n        }"),document.head.appendChild(f)}if(u.innerHTML='\n        <div class="loading-wrapper">\n            <img src="https://img.alicdn.com/tfs/TB1bnUsQBLoK1RjSZFuXXXn0XXa-32-32.svg" alt="加载中">\n            <div>\n                <span>'.concat(e,"</span>\n                ").concat(s?"":"<br />","\n                ").concat(i?'<a href="javascript:;" class="cancel">取消</a>':"","\n            </div>\n        </div>"),i){var p=u.querySelector(".cancel");p&&p.addEventListener("click",function(){c(),i()})}u.addEventListener("click",function(){c()}),u.style.display="flex",u.style.background=o?a:"transparent",u.className="".concat(r," ").concat(o?"show-mask":""),n>0&&(window[l]=setTimeout(function(){c()},1e3*n))},e.sleep=function(e){return new Promise(function(n){return setTimeout(n,e||0)})},e.toUrlParams=v,Object.defineProperty(e,"__esModule",{value:!0})});
